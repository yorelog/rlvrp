需要解决一个考虑拥堵等情况的时间依赖车辆路径问题tdvrp，为了能模拟每天的早晚高峰等情况，你使用二次函数来模拟各个时间段城市中总的车辆密度，通过给定seed的随机生成，分别得到各个节点之间双向路线的车辆密度，再根据lwr模型得到当前时间段各个节点之间双向路线的行驶速度；两个节点之间的双向路线车辆密度随时间线性变化，且所有节点之间的双向路线车辆密度符合当前时间段城市中总的车辆密度。
为了求解TDVRP问题，你创建一个基于GAT的强化学习算法。gat可以学习到节点与节点之间的复杂关系，特别是车辆密度变化关系，同时，还能尽可能的并行化计算；使用ppo算法结合经验回放技术来解决样本相关性和采样效率问题；该项目包含四个主要文件：data.py、model.py、train.py 和 test.py。使用PyTorch Lightning实现并行计算

data.py：负责根据给定的seed生成训练和测试数据，并将它们保存到文件中。各个边具有车辆密度特征，根据车辆密度特征基于lwr模型得到各个边双向通行速度；节点具有时间窗，仓库有运行时间，各个节点的时间窗是仓库运行时间的子集；整个运行时间分为五个时间段，每个时间段会重新给各个边更新车辆密度特征，且各个边的总车辆密度特征符合当前时间段城市中总的车辆密度，城市各个时间段的车辆密度符合一个二次函数，二次函数的参数根据seed给定；不可提前生成未来的车辆密度；
model.py：定义一个基于GAT和PPO的强化学习求解tdvrp的模型；对训练过程的收敛情况，学习效率，数据变化等数据进行记录，使之更具有可解释性。使用PyTorch Lightning实现并行计算。
train.py：加载数据、训练模型，训练过程中尽量并行运算，记录训练过程并保存模型。
test.py：加载模型和测试数据，绘制模型生成的车辆路径方案以及时间维度上的拥堵变化情况。

将生成的数据集划分为训练集和测试集，用于训练和验证。PPO损失函数以最小化所有车辆的总行驶时间为目标，同时考虑时间窗惩罚。在训练过程中，使用TensorBoard观察模型收敛情况、学习效率以及模型对行驶速度变化的反应灵敏度等。
请根据上述背景，写出可运行的完整代码
data.py